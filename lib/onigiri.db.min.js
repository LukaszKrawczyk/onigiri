(function(){db=new function(){this.a=window.localStorage;this.name=null;this.set=function(a){this.name=a;return this};this.save=function(a,b){if(!this.name)return console.error("Please set name of database"),!1;index=this.a.length;for(i in b)"id"in b[i]||(b[i].id=index),this.a.setItem(this.b(a,b[i].id),this.d(b[i])),index++;return!0};this.remove=function(a,b){key=this.b(a,b);this.a.removeItem(key)};this.find=function(a,b){result=[];for(i=0;i<this.a.length;i++)if(key=this.a.key(i),0<=key.indexOf(this.e(a))){obj= this.f(a);totalConditions=foundConditions=0;for(c in b)totalConditions++,b[c]==obj[c]&&foundConditions++;(foundConditions==totalConditions||0==totalConditions)&&result.push(obj)}return result.reverse()};this.f=function(a){key=this.b(a,key.split(".")[2]);return this.c(this.a.getItem(key))};this.b=function(a,b){return this.name+"."+a+"."+b};this.d=function(a){return JSON.stringify(a)};this.c=function(a){eval("var obj = "+a);return obj};this.e=function(a){return this.name+"."+a+"."};this.clear=function(){length= this.a.length;for(i=pointer=0;i<length;i++)key=this.a.key(pointer),0<=key.indexOf(this.name)?this.a.removeItem(key):pointer++;return this}};onigiri=new function(){this.db=db}})();